<UserControl x:Class="HGUniversal.Controls.ModuleControls"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:cff="clr-namespace:Coding4Fun.Toolkit.Controls;assembly=Coding4Fun.Toolkit.Controls"
             xmlns:controls="using:Coding4Fun.Toolkit.Controls"
             xmlns:converters="using:HGUniversal.ViewModel.Converters"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:HomeGenie.ViewModel.Converters"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:modulecontrols="clr-namespace:HomeGenie.Controls"
             FontFamily="{StaticResource PhoneFontFamilyNormal}"
             FontSize="{StaticResource PhoneFontSizeNormal}"
             Foreground="{StaticResource PhoneForegroundBrush}"
             d:DesignHeight="800"
             d:DesignWidth="680"
             mc:Ignorable="d">
    <Grid x:Name="LayoutRoot">
        <Grid.Resources>

            <converters:ModuleAddinVisibilityConverter x:Key="ModuleAddinVisibility" />
            <converters:PropertyAddinVisibilityConverter x:Key="PropertyAddinVisibility" />
            <converters:ModulePropertyConverter x:Key="PropertyConverter" />
            <converters:HsbColorConverter x:Key="HsbColorConverter" />

            <Storyboard x:Name="ModuleControlPopupAnim">
                <DoubleAnimation Duration="0:0:0.2"
                                 From="0.0"
                                 Storyboard.TargetName="LayoutRoot"
                                 Storyboard.TargetProperty="Opacity"
                                 To="1.0" />
            </Storyboard>

        </Grid.Resources>

        <Grid.Background>
            <SolidColorBrush Opacity="0.7" Color="{StaticResource PhoneInverseBackgroundColor}" />
        </Grid.Background>

        <Grid Margin="0,40,0,-40" VerticalAlignment="Center">

            <Border Margin="20"
                    Background="{StaticResource PhoneBackgroundBrush}"
                    BorderBrush="{StaticResource PhoneBorderBrush}"
                    BorderThickness="2"
                    CornerRadius="20" />


            <Grid Margin="40">
                <Grid.RowDefinitions>
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                </Grid.RowDefinitions>


                <TextBlock Grid.Row="0"
                           Margin="0,0,0,14"
                           VerticalAlignment="Bottom"
                           FontFamily="Segoe WP Black"
                           FontSize="32"
                           Foreground="{StaticResource PhoneForegroundBrush}"
                           Style="{StaticResource PhoneTextExtraLargeStyle}"
                           Text="{Binding Name}"
                           TextWrapping="NoWrap" />

                <!--  Status.Level  -->
                <Grid x:Name="ColorPickerBox"
                      Grid.Row="1"
                      Grid.RowSpan="2"
                      Height="350"
                      Background="{StaticResource PhoneBackgroundBrush}"
                      Visibility="{Binding Properties,
                                           Converter={StaticResource PropertyAddinVisibility},
                                           ConverterParameter=Status.ColorHsb}">

                    <TextBlock HorizontalAlignment="Right"
                               VerticalAlignment="Top"
                               FontFamily="Microsoft MHei"
                               FontSize="20"
                               FontWeight="Black"
                               Style="{StaticResource PhoneTextSmallStyle}"
                               Text="{Binding Properties,
                                              Converter={StaticResource PropertyConverter},
                                              ConverterParameter=Status.Level+}" />

                </Grid>


                <!--  Control Buttons  -->
                <Grid Grid.Row="2"
                      Margin="0,0,0,0"
                      Visibility="{Binding DeviceType,
                                           Converter={StaticResource ModuleAddinVisibility},
                                           ConverterParameter=Dimmer:Siren}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="1"
                               FontFamily="Microsoft MHei"
                               Style="{StaticResource PhoneTextAccentStyle}"
                               Text="Level" />

                    <TextBlock Grid.Row="1"
                               HorizontalAlignment="Right"
                               FontFamily="Microsoft MHei"
                               FontSize="20"
                               FontWeight="Black"
                               IsHitTestVisible="False"
                               Style="{StaticResource PhoneTextExtraLargeStyle}"
                               Text="{Binding Properties,
                                              Converter={StaticResource PropertyConverter},
                                              ConverterParameter=Status.Level+}" />

                    <Slider x:Name="ModuleSlider"
                            Grid.Row="2"
                            Margin="10,0,10,0"
                            Foreground="{StaticResource PhoneChromeBrush}"
                            Maximum="1"
                            Minimum="0"
                            Value="{Binding Properties,
                                            Converter={StaticResource PropertyConverter},
                                            ConverterParameter=Status.Level}" />

                </Grid>


                <Grid Grid.Row="3" Visibility="{Binding DeviceType, Converter={StaticResource ModuleAddinVisibility}, ConverterParameter=Dimmer:Light:Switch:Siren}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.ColumnSpan="3"
                                Margin="0,0,0,-12"
                                Background="{StaticResource PhoneBackgroundBrush}" />
                        <Button x:Name="PopupClose"
                                Grid.Column="0"
                                HorizontalAlignment="Left"
                                BorderThickness="1"
                                Content="" />
                        <Button x:Name="ModuleOff"
                                Grid.Column="1"
                                HorizontalAlignment="Stretch"
                                BorderThickness="1"
                                Content="OFF" />
                        <Button x:Name="ModuleOn"
                                Grid.Column="2"
                                HorizontalAlignment="Stretch"
                                BorderThickness="1"
                                Content="ON" />
                    </Grid>
                </Grid>
            </Grid>
        </Grid>
    </Grid>
</UserControl>